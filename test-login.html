<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Test Login</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #1a1d2e; color: white; }
        button { padding: 10px 20px; margin: 10px; cursor: pointer; }
        pre { background: #0a0e27; padding: 15px; border-radius: 8px; overflow: auto; }
        .success { color: #10b981; }
        .error { color: #ef4444; }
    </style>
</head>
<body>
    <h1>Test Connexion Mock</h1>
    
    <div>
        <button onclick="testLoginAdmin()">Login Admin</button>
        <button onclick="testLoginProf()">Login Prof</button>
        <button onclick="testLoginEtudiant()">Login √âtudiant</button>
        <button onclick="checkStorage()">V√©rifier Storage</button>
        <button onclick="clearStorage()">Vider Storage</button>
    </div>
    
    <pre id="result"></pre>

    <script src="js/mock-data.js?v=6"></script>
    <script src="js/api.js?v=6"></script>
    <script>
        const result = document.getElementById('result');
        
        async function testLoginAdmin() {
            result.textContent = 'Test login admin...';
            try {
                const data = await API.login('admin@uan.bf', 'admin123');
                result.innerHTML = '<span class="success">‚úÖ Login admin r√©ussi!</span>\n' + JSON.stringify(data, null, 2);
                
                // V√©rifier le storage
                setTimeout(() => {
                    const user = localStorage.getItem('erp_user');
                    result.innerHTML += '\n\n<span class="success">Storage:</span>\n' + user;
                }, 100);
            } catch (err) {
                result.innerHTML = '<span class="error">‚ùå Erreur: ' + err.message + '</span>';
            }
        }
        
        async function testLoginProf() {
            result.textContent = 'Test login prof...';
            try {
                const data = await API.login('j.ouedraogo@uan.bf', 'enseignant123');
                result.innerHTML = '<span class="success">‚úÖ Login prof r√©ussi!</span>\n' + JSON.stringify(data, null, 2);
                
                setTimeout(() => {
                    const user = localStorage.getItem('erp_user');
                    result.innerHTML += '\n\n<span class="success">Storage:</span>\n' + user;
                }, 100);
            } catch (err) {
                result.innerHTML = '<span class="error">‚ùå Erreur: ' + err.message + '</span>';
            }
        }
        
        async function testLoginEtudiant() {
            result.textContent = 'Test login √©tudiant...';
            try {
                const data = await API.login('m.diallo@etu.bf', 'etudiant123');
                result.innerHTML = '<span class="success">‚úÖ Login √©tudiant r√©ussi!</span>\n' + JSON.stringify(data, null, 2);
                
                setTimeout(() => {
                    const user = localStorage.getItem('erp_user');
                    result.innerHTML += '\n\n<span class="success">Storage:</span>\n' + user;
                }, 100);
            } catch (err) {
                result.innerHTML = '<span class="error">‚ùå Erreur: ' + err.message + '</span>';
            }
        }
        
        function checkStorage() {
            const user = localStorage.getItem('erp_user');
            const access = localStorage.getItem('erp_access_token');
            const refresh = localStorage.getItem('erp_refresh_token');
            
            result.innerHTML = '<span class="success">üì¶ LocalStorage:</span>\n\n';
            result.innerHTML += 'erp_user: ' + (user || 'NULL') + '\n\n';
            result.innerHTML += 'erp_access_token: ' + (access || 'NULL') + '\n\n';
            result.innerHTML += 'erp_refresh_token: ' + (refresh || 'NULL');
        }
        
        function clearStorage() {
            localStorage.clear();
            result.innerHTML = '<span class="success">‚úÖ Storage vid√©</span>';
        }
    </script>
</body>
</html>
